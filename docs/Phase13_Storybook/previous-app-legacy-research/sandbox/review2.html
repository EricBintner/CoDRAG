<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Halley Visual Design Review 2 (Q–R)</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            sans: ['Inter', 'system-ui', '-apple-system', 'Segoe UI', 'Roboto', 'Arial', 'sans-serif'],
          },
          colors: {
            bg: '#0b0f16',
            card: '#111826',
            'card-2': '#0f1522',
            border: 'rgba(255,255,255,0.10)',
            border2: 'rgba(255,255,255,0.16)',
            text: '#eaf0ff',
            muted: 'rgba(234,240,255,0.72)',
            accent: '#7aa7ff',
          }
        }
      }
    }
  </script>
  <style>
    body { background: radial-gradient(circle at 20% 10%, rgba(122,167,255,0.12), transparent 40%), #0b0f16; color: #eaf0ff; }
    .card-surface { background: rgba(17,24,38,0.72); backdrop-filter: blur(10px); }
  </style>
</head>
<body class="min-h-screen font-sans">
  <div class="max-w-7xl mx-auto px-6 py-10">
    <header class="mb-8">
      <div class="flex items-start justify-between gap-6 flex-wrap">
        <div>
          <div class="inline-flex items-center gap-2 text-xs tracking-wider uppercase text-muted mb-3">
            <span class="px-2 py-1 rounded-full border border-border2 bg-white/5">Phase 57</span>
            <span>Review 2</span>
          </div>
          <h1 class="text-3xl md:text-4xl font-semibold tracking-tight">Halley Visual Design Review 2 (Q–R)</h1>
          <p class="text-muted mt-3 max-w-2xl">
            Two app-shell themes that map directly to Halley’s main Chat surface and a mock Personas tab.
            Each includes light/dark switching and avoids “cards everywhere”.
          </p>
        </div>
        <div class="flex gap-3">
          <a href="index.html" class="inline-flex items-center justify-center px-4 py-2 rounded-xl border border-border2 bg-white/5 hover:bg-white/10 transition text-sm">
            Back to Sandbox Index
          </a>
          <a href="review.html" class="inline-flex items-center justify-center px-4 py-2 rounded-xl border border-border2 bg-white/5 hover:bg-white/10 transition text-sm">
            Review A–P
          </a>
        </div>
      </div>
    </header>

    <section class="card-surface rounded-2xl border border-border p-5 mb-8">
      <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
        <div>
          <label class="block text-xs text-muted tracking-wider uppercase mb-2" for="search">Search</label>
          <input id="search" class="w-full px-4 py-3 rounded-xl bg-card-2 border border-border2 text-text placeholder:text-muted/70 focus:outline-none focus:ring-2 focus:ring-accent/40" placeholder="e.g. yale, stepper, chat, personas" />
        </div>
        <div>
          <label class="block text-xs text-muted tracking-wider uppercase mb-2" for="filter">Filter</label>
          <select id="filter" class="w-full px-4 py-3 rounded-xl bg-card-2 border border-border2 text-text focus:outline-none focus:ring-2 focus:ring-accent/40">
            <option value="all">All</option>
            <option value="app_shell">App Shell Themes (Q–R)</option>
          </select>
        </div>
        <div class="flex items-end">
          <label class="inline-flex items-center gap-3 px-4 py-3 rounded-xl border border-border2 bg-white/5 hover:bg-white/10 transition cursor-pointer select-none w-full">
            <input id="autopreview" type="checkbox" class="accent-accent" />
            <span class="text-sm">Auto-open previews as you scroll (heavier)</span>
          </label>
        </div>
      </div>
      <div class="text-xs text-muted mt-3">
        Tip: Open each theme in a new tab and use the in-page light/dark toggle to compare.
      </div>
    </section>

    <section id="grid" class="grid grid-cols-1 lg:grid-cols-2 gap-5"></section>

    <footer class="mt-10 text-sm text-muted">
      Goal: evaluate design-system posture with real-ish Halley surfaces (Chat + Personas) before committing to tokens/components.
    </footer>
  </div>

  <template id="cardTemplate">
    <article class="card-surface rounded-2xl border border-border p-6">
      <div class="flex items-start justify-between gap-4">
        <div>
          <div class="flex items-center gap-3">
            <span class="var-badge px-2 py-1 text-xs font-semibold rounded-lg border border-border2 bg-white/5"></span>
            <h2 class="var-title text-xl font-semibold tracking-tight"></h2>
          </div>
          <p class="var-tagline text-sm text-muted mt-2"></p>
          <div class="mt-3 flex flex-wrap gap-2 var-chips"></div>
        </div>
        <div class="flex gap-2 flex-shrink-0">
          <a class="var-open inline-flex items-center justify-center px-4 py-2 rounded-xl border border-border2 bg-white/5 hover:bg-white/10 transition text-sm" target="_blank" rel="noreferrer">Open</a>
        </div>
      </div>

      <div class="mt-5 grid gap-4">
        <div>
          <div class="text-xs text-muted tracking-wider uppercase">Best fit in Halley</div>
          <div class="var-fit text-sm mt-1"></div>
        </div>
        <div>
          <div class="text-xs text-muted tracking-wider uppercase">System moves to borrow</div>
          <div class="var-moves text-sm mt-1"></div>
        </div>
        <div>
          <div class="text-xs text-muted tracking-wider uppercase">Watch-outs</div>
          <div class="var-risks text-sm mt-1"></div>
        </div>
      </div>

      <details class="mt-5 var-details rounded-xl border border-border2 bg-black/10">
        <summary class="cursor-pointer px-4 py-3 text-sm select-none">Preview</summary>
        <div class="p-4 pt-0">
          <div class="rounded-xl overflow-hidden border border-border bg-black">
            <iframe class="var-iframe w-full" style="height: 520px;" loading="lazy" referrerpolicy="no-referrer"></iframe>
          </div>
        </div>
      </details>
    </article>
  </template>

  <script>
    const variations = [
      {
        id: 'Q',
        title: 'App Shell — Yale Grid',
        category: 'app_shell',
        path: 'variation-q-yale-appshell/index.html',
        tagline: 'Grid-first, typography discipline, low ornament. Light/dark toggle. Minimal “carding”.',
        chips: ['Calm', 'Grid', 'Chat + Personas'],
        fit: 'Strong candidate for Halley’s main day-to-day surfaces: chat reading/writing and persona editing.',
        moves: 'Baseline rhythm, hairline rules, stable layout grid, restrained accent use.',
        risks: 'Requires excellent typography/copy; can feel too quiet without intentional brand moments.'
      },
      {
        id: 'R',
        title: 'App Shell — Guided Stepper',
        category: 'app_shell',
        path: 'variation-r-guided-stepper-appshell/index.html',
        tagline: 'Progressive disclosure posture: onboarding/config becomes a system pattern. Light/dark toggle.',
        chips: ['Onboarding', 'Progressive disclosure', 'Chat + Personas'],
        fit: 'High-leverage for persona/world setup and safety/memory policy configuration; keeps complexity humane.',
        moves: 'Stepper component, review/confirm moments, live preview, explicit system copy.',
        risks: 'Must not slow experts; allow skipping and keep steppers for the right tasks.'
      }
    ]

    const grid = document.getElementById('grid')
    const search = document.getElementById('search')
    const filter = document.getElementById('filter')
    const autopreview = document.getElementById('autopreview')
    const template = document.getElementById('cardTemplate')

    const setIframeSrcIfNeeded = (iframe) => {
      if (!iframe) return
      const desired = iframe.getAttribute('data-src')
      if (desired && !iframe.getAttribute('src')) iframe.setAttribute('src', desired)
    }

    const render = () => {
      const q = (search.value || '').trim().toLowerCase()
      const f = filter.value

      grid.innerHTML = ''

      const visible = variations.filter(v => {
        if (f !== 'all' && v.category !== f) return false
        if (!q) return true
        const hay = [v.id, v.title, v.tagline, v.fit, v.moves, v.risks, ...(v.chips || [])].join(' ').toLowerCase()
        return hay.includes(q)
      })

      for (const v of visible) {
        const node = template.content.cloneNode(true)
        const article = node.querySelector('article')

        node.querySelector('.var-badge').textContent = v.id
        node.querySelector('.var-title').textContent = v.title
        node.querySelector('.var-tagline').textContent = v.tagline

        const chips = node.querySelector('.var-chips')
        for (const c of v.chips || []) {
          const span = document.createElement('span')
          span.className = 'text-xs px-2 py-1 rounded-lg border border-border2 bg-white/5 text-muted'
          span.textContent = c
          chips.appendChild(span)
        }

        node.querySelector('.var-fit').textContent = v.fit
        node.querySelector('.var-moves').textContent = v.moves
        node.querySelector('.var-risks').textContent = v.risks

        const open = node.querySelector('.var-open')
        open.setAttribute('href', v.path)

        const details = node.querySelector('.var-details')
        const iframe = node.querySelector('.var-iframe')
        iframe.setAttribute('data-src', v.path)

        details.addEventListener('toggle', () => {
          if (details.open) setIframeSrcIfNeeded(iframe)
        })

        if (autopreview.checked) {
          details.open = true
          setIframeSrcIfNeeded(iframe)
        }

        grid.appendChild(node)

        if (!autopreview.checked) {
          const io = new IntersectionObserver((entries) => {
            for (const e of entries) {
              if (!e.isIntersecting) continue
              if (autopreview.checked) {
                const d = article.querySelector('details')
                const f = article.querySelector('iframe')
                if (d && !d.open) d.open = true
                setIframeSrcIfNeeded(f)
              }
              io.disconnect()
            }
          }, { rootMargin: '400px' })
          io.observe(article)
        }
      }
    }

    search.addEventListener('input', render)
    filter.addEventListener('change', render)
    autopreview.addEventListener('change', render)

    render()
  </script>
</body>
</html>
